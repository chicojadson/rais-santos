---
title: "Mercado de Trabalho no Setor Portuário"
crossref:
  tbl-prefix: Tabela
  tbl-title: Tabela
  fig-prefix: Figura
  fig-title: Figura
filters:
  - docx-landscape.lua
language: _language-pt-BR.yml
execute:
  echo: false
format: 
  docx:
    toc: true
    toc-title: "Sumário"
    number-sections: true
    reference-doc: custom-reference-doc.docx
    fig-width: 14
    fig-height: 10
    fig-align: "center"
    lang: pt
    logo: www/logo.png
    bibliography: "https://api.citedrive.com/bib/2b128e92-3e74-4dfb-9275-4460f9b41e23/references.bib?x=eyJpZCI6ICIyYjEyOGU5Mi0zZTc0LTRkZmItOTI3NS00NDYwZjliNDFlMjMiLCAidXNlciI6ICIxMzA0MCIsICJzaWduYXR1cmUiOiAiNjlmMWNmYWRlMmFkNDJlMDQ5MjQzNzViNmU4YWJhYWM1ZDM3OWUyMmE1NjAyN2YzYzE5YzE0YmRlNjMzYWM3YSJ9"
    csl: associacao-brasileira-de-normas-tecnicas.csl
---

```{r lendo, context = "data", include=FALSE}


pacman::p_load("basedosdados", "tidyverse", 
               "dbplyr", "scales", "kableExtra", "ggrepel")

# install.packages('devtools')
# devtools::install_github('bbc/bbplot')
library(bbplot)
library(kableExtra)


#lendo os dados da rais
rais <- read_csv(file = "dados/rais.csv",
                 col_type = list(.default = "f",
                                 valor_remuneracao_media = "d",
                                 ano = "i"))

manipulacao <- function(dataset, nivel1, nivel2){
  lvls_ano = c(seq(2024,2024,1))
  dataset %>% 
  group_by({{nivel1}}, {{nivel2}}, ano) %>% # agrupamento
  summarise(n = n(), .groups = "drop") %>% #sumarização
  mutate({{nivel2}} := forcats::fct_reorder({{nivel2}}, n)) %>% # reordenamento de níveis
  arrange(desc(n)) %>% #ordenamento em ordem decrescente
  filter(!is.na({{nivel2}})) 
}



# Adicione esta linha no início do seu script se ainda não tiver
# library(stringr)

grafico <- function(dataset, 
                    nivel1, 
                    nivel2, 
                    titulo, 
                    escala_n = 1/1000,
                    sufixo_n = " mil",
                    decimal_n = ",",
                    separador_milhar = ".",
                    precisao_n = 0.01){
  
  # Função para formatar números
  formatar_numero <- function(x) {
    scales::number(
      x,
      scale = escala_n,
      decimal.mark = decimal_n,
      big.mark = separador_milhar,
      accuracy = precisao_n,
      suffix = sufixo_n
    )
  }
  
  nivel1 <- enquo(nivel1)
  nivel2 <- enquo(nivel2)
  
  # Criar versão modificada do dataset com títulos quebrados
  dataset_modificado <- dataset %>%
    mutate(
      # Quebra o texto do nível1 após 30 caracteres
      nivel1_wrapped = str_wrap(!!nivel1, width = 30)
    )
  
  # Calcular pontos máximo e mínimo
  pontos_max <- dataset_modificado %>%
    group_by(!!nivel1, !!nivel2) %>%
    filter(n == max(n)) %>%
    ungroup()
  
  pontos_min <- dataset_modificado %>%
    group_by(!!nivel1, !!nivel2) %>%
    filter(n == min(n)) %>%
    ungroup()
  
  # Identificar anos disponíveis nos dados (2024-2024)
  anos_disponiveis <- sort(unique(dataset_modificado$ano))
  
  # Definir anos para destacar (2024 e 2024 - primeiro e último)
  primeiro_ano <- min(anos_disponiveis)  # 2024
  ultimo_ano <- max(anos_disponiveis)    # 2024
  
  # Pontos para anos destacados (2024 e 2024)
  pontos_destacados <- dataset_modificado %>% 
    filter(ano %in% c(primeiro_ano, ultimo_ano))
  
  dataset_modificado %>% 
    ggplot(
      aes(
        x = ano, 
        y = n, 
        group = {{nivel2}},
        color = {{nivel2}}
      )
    ) +
    # Linhas
    geom_line(
      aes(color = {{nivel2}}),
      size = 1.5,
      alpha = 0.8
    ) +
    # Pontos em TODOS os anos (2024-2024)
    geom_point(
      color = "black", 
      size = 2.5,
      shape = 16
    ) +
    # Pontos máximo e mínimo (sobrepõe com cor diferente se necessário)
    geom_point(
      data = pontos_max,
      aes(x = ano, y = n),
      color = "black",
      size = 3,
      shape = 16
    ) +
    geom_point(
      data = pontos_min,
      aes(x = ano, y = n),
      color = "black",
      size = 3,
      shape = 16
    ) +
    labs(
      title = titulo,
      y = "Número de vínculos",
      caption = "Fonte: Observatório Portuário - Dados da RAIS",
      x = "Ano"
    ) +
    # Labels para pontos mínimos - AZUL, à ESQUERDA
    geom_text_repel(
      data = pontos_min,
      aes(label = formatar_numero(n)),
      nudge_x = -0.3,
      direction = "y",
      hjust = "right",
      vjust = "center",
      size = 4,
      box.padding = 0.5,
      point.padding = 0.7,
      min.segment.length = 0.3,
      segment.color = "black",
      segment.size = 0.4,
      segment.alpha = 0.7,
      max.overlaps = 50,
      force = 1.5,
      fontface = "bold",
      family = "sans",
      color = "black"
    ) +
    # Labels para pontos máximos - VERMELHO, à DIREITA
    # geom_text_repel(
    #   data = pontos_max,
    #   aes(label = formatar_numero(n)),
    #   nudge_x = 0.3,
    #   direction = "y",
    #   hjust = "left",
    #   vjust = "center",
    #   size = 4,
    #   box.padding = 0.5,
    #   point.padding = 0.7,
    #   min.segment.length = 0.3,
    #   segment.color = "red",
    #   segment.size = 0.4,
    #   segment.alpha = 0.7,
    #   max.overlaps = 50,
    #   force = 1.5,
    #   fontface = "bold",
    #   family = "sans",
    #   color = "red"
    # ) +
    # Labels para pontos dos anos 2024 e 2024
    geom_text_repel(
      data = pontos_destacados,
      aes(label = formatar_numero(n)),
      nudge_y = 0.08,
      direction = "y",
      hjust = "center",
      vjust = ifelse(pontos_destacados$ano == primeiro_ano, "bottom", "top"),
      size = 4,
      box.padding = 0.3,
      point.padding = 0.5,
      min.segment.length = 0.2,
      segment.color = "gray40",
      segment.size = 0.3,
      segment.alpha = 0.6,
      max.overlaps = 30,
      force = 1,
      fontface = "bold",
      family = "sans",
      color = "black"
    ) +
    # Facet
    facet_wrap(vars(nivel1_wrapped), ncol = 2, scales = "fixed") +
    theme_minimal() +
    theme(
      plot.title = element_text(size = 18L, face = "bold", hjust = 0.5, margin = margin(b = 15)),
      plot.caption = element_text(size = 12L, face = "bold", hjust = 0, margin = margin(t = 10)), 
      axis.title.y = element_text(size = 14L, face = "bold", margin = margin(r = 10)), 
      axis.title.x = element_text(size = 14L, face = "bold", margin = margin(t = 10)),
      axis.text.x = element_text(size = 12L, face = "bold"),
      axis.text.y = element_text(size = 12L, face = "bold"),
      legend.text = element_text(size = 13L),
      legend.title = element_text(size = 14L, face = "bold"),
      panel.grid.major = element_line(color = "gray90", size = 0.3),
      panel.grid.minor = element_blank(),
      panel.border = element_rect(fill = NA, color = "gray80", size = 0.5),
      panel.spacing = unit(1.5, "lines"),
      legend.position = "top",
      legend.justification = "center",
      legend.box = "horizontal",
      legend.margin = margin(b = 10),
      strip.text = element_text(size = 11, face = "bold", color = "black"),
      strip.background = element_rect(fill = "gray95", color = "gray80", size = 0.5),
      plot.margin = margin(20, 20, 20, 20)
    ) +
    # Escala de cores para as linhas
    scale_color_brewer(palette = "Set1", name = "Legenda:") +
    # EIXO X: Mostra apenas 2024, 2021, 2022, 2023, 2024
    scale_x_continuous(
      breaks = anos_disponiveis,  # Apenas 2024-2024
      labels = anos_disponiveis,
      expand = expansion(mult = c(0.05, 0.05))
    ) +
    # Eixo Y formatado
    scale_y_continuous(
      labels = function(x) {
        scales::number(
          x,
          scale = escala_n,
          decimal.mark = decimal_n,
          big.mark = separador_milhar,
          accuracy = precisao_n
        )
      }
    )
}
```

```{r, include=FALSE}
# Definir a ordem desejada (hierarquia educacional)
ordem_instrucao <- c(
  "Fundamental incompleto",
  "Fundamental completo",
  "Médio incompleto",
  "Médio completo",
  "Superior incompleto",
  "Superior completo",
  "Pós-graduação",
  "Mestrado",
  "Doutorado"
)

# Criar função de mapeamento
mapear_instrucao <- function(x) {
  case_when(
    x == "ANALFABETO" ~ "Analfabeto",
    x %in% c("ATE 5.A INC", "5.A CO FUND", "6. A 9. FUND") ~ "Fundamental incompleto",
    x %in% c("FUND COMPL") ~ "Fundamental completo",
    x == "MEDIO INCOMP" ~ "Médio incompleto",
    x == "MEDIO COMPL" ~ "Médio completo",
    x == "SUP. INCOMP" ~ "Superior incompleto",
    x == "SUP. COMP" ~ "Superior completo",
    x == "MESTRADO" ~ "Mestrado",
    x == "DOUTORADO" ~ "Doutorado",
    TRUE ~ "Não informado"  # Para quaisquer outros valores
  )
}

# Aplicar mapeamento e converter para fator ordenado
rais <- rais %>%
  mutate(
    grau_instrucao_apos_2005 = mapear_instrucao(grau_instrucao_apos_2005),
    grau_instrucao_apos_2005 = factor(
      grau_instrucao_apos_2005,
      levels = ordem_instrucao,
      ordered = TRUE
    )
  )

# Verificar resultado com contagem
# rais |> 
#   count(grau_instrucao_apos_2005) |> 
#   arrange(grau_instrucao_apos_2005)



virgula <- function(x) format(x, digits = 2, big.mark = ".", decimal.mark = ",")

```

```{=html}
<style>
body {
text-align: justify;
font-family: "Times New Roman";
font-size: 14px}
</style>
```

# Introdução

O setor portuário impacta direta e indiretamente a economia do país.

O Observatório Portuário apresenta neste relatório uma síntese da evolução do Trabalho Portuário e Aquaviário dos municípios de Santos e de Guarujá entre 2020 e 2024.

Trata-se de um setor abrangente e com atividades diversas como instalações portuárias, embarcações mercantes, de passageiros, pesca, atividades em plataformas marítimas e de rerapação naval que movimentam inúmeras cadeias produtivas e setores econômicos.

Espera-se que as informações apresentadas (a metodologia está disponível na última seção) possam auxiliar o debate no setor e subsidiar a elaboração de políticas de gestão públicas e privadas.

Por fim, a RAIS dividide-se em `Seção > Divisão > Grupo > Classe Subclasse`, conforme decrito no capítulo **Notas Metodológicas**.

Boa leitura.

# Panorama do trabalho no setor portuário e aquaviário

As estratégias para o setor Portuário e Aquaviário influenciaram o estoque de empregos no setor, sobretudo ao considerar as mudanças regulatórias e ciclos de investimento.

Ao considerar os dados mais recentes, verifica-se que foram registrados `r rais |> group_by(ano) |> filter(ano == 2020 & id_municipio_nome == "Santos") |> count() |> pull(n) |> virgula()` vínculos em Santos em 2020, que passou para `r rais |> group_by(ano) |> filter(ano == 2024 & id_municipio_nome == "Santos") |> count() |> pull(n) |> virgula()` em 2024. Quanto ao município de Guarujá, constata-se que foram registrados `r rais |> group_by(ano) |> filter(ano == 2020 & id_municipio_nome == "Guarujá") |> count() |> pull(n) |> virgula()` vínculos no setor em 2020, que valor passsou para `r rais |> group_by(ano) |> filter(ano == 2024 & id_municipio_nome == "Guarujá") |> count() |> pull(n) |> virgula()` em 2024. Ademais, uma pessoa pode ter mais de um vínculo, por exemplo) no setor portuário e aquaviário no Brasil em 2024, de acordo com os dados da Relação Anual de Informações Sociais (RAIS).

<br>

```{r g_secao,  echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
#| fig-width: 14
#| fig-height: 12
#| fig-align: "center"


lvls_ano <- as.character(seq(2020, 2024))


g1<-
  rais |>
  filter(!is.na(cnae_2_subclasse_descricao_secao)) |> 
  group_by(ano, id_municipio_nome, cnae_2_subclasse_descricao_secao) |> 
  summarise(n = n()) |> 
  mutate(ano = factor(ano, lvls_ano))

g1 |> 
ggplot(aes(x = ano, y = n, group = cnae_2_subclasse_descricao_secao)) +
  geom_line(aes(color = cnae_2_subclasse_descricao_secao), size = 2.25) +
  geom_point(color = "black", size = 6) +
  ggrepel::geom_text_repel(aes(x = ano, y = n, size = 4, label = scales::number(n, scale = 1/1000, decimal.mark = ",", big.mark = ".", accuracy = 0.01, suffix = " mil")), nudge_x = -0.2, direction = "y", hjust = "right", size = 4) +
  facet_grid(~id_municipio_nome) +
  bbc_style() +
  labs(
       title = "Vínculos do Setor Portuário e Aquaviário por município (2024 - 2024)", 
       caption = "Fonte: Observatório Portuário - Dados da RAIS") +
    ggthemes::scale_color_gdocs() +
  scale_y_continuous(labels = label_number(scale = 1/1000, suffix = " mil")) +
  theme(legend.position = "none",
        plot.title = element_text(size = rel(2)),
        panel.grid.major.x  = element_line(color = "black", linetype = "dotted", size = 0.1),
    panel.grid.major.y  = element_line(color = "black", linetype = "dotted", size = 0.1)
        )


      

```

<br>

Ao analisar os dados por setor de atividade no contexto nacional, verifica-se redução do número de vínculos no **seção** de profissionais atuantes no **Transporte Aquaviário**, com uma redução de 44.420 vínculos em 2013 para 37.910 em 2024, com uma redução de 6.510 vínculos.

Por outro lado, nota-se que o grupo de atividades agrupadas como **Armazenamento e Atividades Auxiliares dos Transportes** apresentou um comportamento crescente no período, superando em 2024 o número de vínculos no **Transporte Aquaviário**.

<br>

```{r,  echo=FALSE, message=FALSE, warning=FALSE, results='hide', fig.height=10, fig.width=12}
g2 <- rais |>
  filter(
    id_municipio_nome == "Santos" &
    !is.na(cnae_2_subclasse_descricao_classe)) |> 
  group_by(ano, cnae_2_subclasse_descricao_classe) |> 
  summarise(n = n(), .groups = "drop") |> 
  mutate(ano = factor(ano, lvls_ano)) 

g2_max <- g2 |> 
  group_by(cnae_2_subclasse_descricao_classe) |> 
  filter(n == max(n))

g2_min <- g2 |> 
  group_by(cnae_2_subclasse_descricao_classe) |> 
  filter(n == min(n))

g2_2024 <- g2 |> 
  filter(ano == "2024")  # se ano for fator, usar string


label <- g2 |> filter(ano == 2024 & n >= 1000) |> pull(cnae_2_subclasse_descricao_classe)


g2 <- g2 |> filter(cnae_2_subclasse_descricao_classe %in% label)
# Versão simplificada - sem converter ano
g2_facet_simples <- ggplot(g2, aes(x = ano, y = n, group = 1)) +
  
  # Linha principal
  geom_line(color = "#1380A1", size = 2, lineend = "round") +
  
  # Pontos
  geom_point(size = 4, color = "#333333", fill = "white", shape = 21, stroke = 1.5) +
  
  # Labels nos extremos (2020 e 2024)
  geom_text(
    data = g2 %>% filter(ano %in% c("2020", "2024")),
    aes(label = scales::number(n,
                               scale = 1/1000,
                               decimal.mark = ",",
                               big.mark = ".",
                               accuracy = 0.1,
                               suffix = " mil")),
    nudge_y = ifelse(g2 %>% filter(ano %in% c("2020", "2024")) %>% pull(ano) == "2020", 
                     -max(g2$n) * 0.05, 
                     max(g2$n) * 0.05),
    size = 3.5,
    fontface = "bold",
    color = "white"
  ) +
  
  # Facet
  facet_wrap(
    ~ str_wrap(cnae_2_subclasse_descricao_classe, 30),
    scales = "fixed",
    ncol = 2
  ) +
  
  # Estilo BBC básico
  bbc_style() +
  
  labs(
    title = "Evolução de Vínculos por Classe de Atividade \n Santos - Setor Portuário (2020-2024)",
    subtitle = "com mais de 1 mil colaboradores",
    caption = "Fonte: RAIS - Observatório Portuário",
    x = "",
    y = "Vínculos (milhares)"
  ) +
  
  scale_y_continuous(
    labels = function(x) scales::number(x, scale = 1/1000),
    limits = c(0, NA),  # Começar do zero, sem limite superior
    expand = expansion(mult = c(0, 0.1))  # 10% de expansão no topo
  ) +
  theme(
    plot.title = element_text(size = 20, hjust = 0.5, face = "bold"),
    plot.subtitle = element_text(size = 14, hjust = 0.5),
    plot.caption = element_text(size = 10, hjust = 0),
    strip.text = element_text(size = 10, face = "bold"),
    strip.background = element_rect(fill = "#1380A1"),
    axis.text.x = element_text(angle = 0, size = 10),
    panel.spacing = unit(1.2, "lines")
  )

print(g2_facet_simples)
```

<br>




```{r,  echo=FALSE, message=FALSE, warning=FALSE, results='hide', fig.height=10, fig.width=12}
g2 <- rais |>
  filter(
    id_municipio_nome == "Guarujá" &
    !is.na(cnae_2_subclasse_descricao_classe)) |> 
  group_by(ano, cnae_2_subclasse_descricao_classe) |> 
  summarise(n = n(), .groups = "drop") |> 
  mutate(ano = factor(ano, lvls_ano)) 

g2_max <- g2 |> 
  group_by(cnae_2_subclasse_descricao_classe) |> 
  filter(n == max(n))

g2_min <- g2 |> 
  group_by(cnae_2_subclasse_descricao_classe) |> 
  filter(n == min(n))

g2_2024 <- g2 |> 
  filter(ano == "2024")  # se ano for fator, usar string


label <- g2 |> filter(ano == 2024 & n >= 1000) |> pull(cnae_2_subclasse_descricao_classe)


g2 <- g2 |> filter(cnae_2_subclasse_descricao_classe %in% label)
# Versão simplificada - sem converter ano
g2_facet_simples <- ggplot(g2, aes(x = ano, y = n, group = 1)) +
  
  # Linha principal
  geom_line(color = "#1380A1", size = 2, lineend = "round") +
  
  # Pontos
  geom_point(size = 4, color = "#333333", fill = "white", shape = 21, stroke = 1.5) +
  
  # Labels nos extremos (2020 e 2024)
  geom_text(
    data = g2 %>% filter(ano %in% c("2020", "2024")),
    aes(label = scales::number(n,
                               scale = 1/1000,
                               decimal.mark = ",",
                               big.mark = ".",
                               accuracy = 0.1,
                               suffix = " mil")),
    nudge_y = ifelse(g2 %>% filter(ano %in% c("2020", "2024")) %>% pull(ano) == "2020", 
                     -max(g2$n) * 0.05, 
                     max(g2$n) * 0.05),
    size = 3.5,
    fontface = "bold",
    color = "white"
  ) +
  
  # Facet
  facet_wrap(
    ~ str_wrap(cnae_2_subclasse_descricao_classe, 30),
    scales = "fixed",
    ncol = 2
  ) +
  
  # Estilo BBC básico
  bbc_style() +
  
  labs(
    title = "Evolução de Vínculos por Classe de Atividade \n Guarujá - Setor Portuário (2020-2024)",
    subtitle = "com mais de 1 mil colaboradores",
    caption = "Fonte: RAIS - Observatório Portuário",
    x = "",
    y = "Vínculos (milhares)"
  ) +
  
  scale_y_continuous(
    labels = function(x) scales::number(x, scale = 1/1000),
    limits = c(0, NA),  # Começar do zero, sem limite superior
    expand = expansion(mult = c(0, 0.1))  # 10% de expansão no topo
  ) +
  theme(
    plot.title = element_text(size = 20, hjust = 0.5, face = "bold"),
    plot.subtitle = element_text(size = 14, hjust = 0.5),
    plot.caption = element_text(size = 10, hjust = 0),
    strip.text = element_text(size = 10, face = "bold"),
    strip.background = element_rect(fill = "#1380A1"),
    axis.text.x = element_text(angle = 0, size = 10),
    panel.spacing = unit(1.2, "lines")
  )

print(g2_facet_simples)
```

Ao analisar os grupos de atividades com maior participação no número de vínculos empregatícios, destacam-se as atividades de **Armazenamento e Atividades Auxiliares dos Transportes** e **Transporte Aquaviário**.

O **Armazenamento e Atividades Auxiliares dos Transportes** compreende, de acordo com a Classificação Nacional de Atividades Econômicas-CNAE, atividades relacionadas

> \[...\] com a movimentação e o armazenamento de cargas, antes ou depois de seu transporte, ou entre segmentos de transporte de distintas modalidades, as atividades auxiliares das diversas modalidades de transporte envolvendo a operação da infraestrutura de suporte nas rodovias, ferrovias, aeroportos, portos, pontes túneis, etc. e as atividades de agenciamento de transporte. Esta divisão compreende também as atividades relacionadas à organização do transporte de carga.

Destaque também deve ser dado para o número de vínculos do \*\*Transporte Aquaviário\*\*, cujas atividades são as relacionadas aos transportes de pessoas e mercadorias, além das embarcações turísticas e o fretamento de embarcações com tripulação. Nela também estão as operações e embarcações para apoio marítimo e portuário.

No gráfico a seguir estão detalhados os vínculos e atividades contemplados no Transporte Aquaviário no país.

Com o recorte, verifica-se que as atividades de **Navegação de Apoio** apresentam o maior número de vínculos, registrando em 2024 18.237 empregos. A categoria abarca atividades como:

-   o transporte de mercadorias e pessoas para suprimento e apoio a navios e a plataformas de pesquisas e exploração de minerais e hidrocarbonetos;

-   a navegação realizada para apoio logístico a navios e a plataformas de exploração de minerais e hidrocarbonetos transporte;

-   a navegação realizada nos portos e terminais aquaviários, para atendimento a embarcações e instalações portuárias;

-   os serviços de reboque realizado por empresas de apoio marítimo;

-   os serviços de socorro e salvamento realizado por empresas de apoio portuário.

Observa-se que o grupo de **Transporte por Navegação Interior**, segundo maior grupo em número de vínculos no **Transporte Aquaviário**, finalizou 2024 com 11.488 vínculos. São atividades como *o transporte de carga municipal, por rios, canais, lagos, lagoas, baias e outras vias de navegação interior, exceto travessia* e *o fretamento de embarcações com tripulação*, mas não inclui a *operação e gestão de terminais de carga*.

\
<br>

```{r g_divisao_guarujá,  echo=FALSE, message=FALSE, warning=FALSE, results='hide', fig.height=10, fig.width=12}

g2 <- rais |>
  filter(!is.na(cnae_2_subclasse_descricao_divisao)) |> 
  group_by(ano, id_municipio_nome, cnae_2_subclasse_descricao_divisao) |> 
  summarise(n = n(), .groups = "drop") |> 
  mutate(ano = factor(ano, lvls_ano)) 

g2_max <- g2 |> 
  group_by(cnae_2_subclasse_descricao_divisao) |> 
  filter(n == max(n))

g2_min <- g2 |> 
  group_by(cnae_2_subclasse_descricao_divisao) |> 
  filter(n == min(n))

g2_2024 <- g2 |> 
  filter(ano == "2024")  # se ano for fator, usar string

ggplot(g2, aes(x = ano, y = n, group = cnae_2_subclasse_descricao_divisao, color = cnae_2_subclasse_descricao_divisao)) +
  geom_line(size = 2) +
  geom_point(color = "black", size = 3) +
  geom_point(data = g2_max, size = 3) +
  geom_text_repel(
    data = g2_max,
    aes(label = scales::number(n,
                               scale = 1/1000,
                               decimal.mark = ",",
                               big.mark = ".",
                               accuracy = 0.01,
                               suffix = " mil")),
    nudge_x = +0.4,
    direction = "y",
    hjust = "right",
    size = 6
  ) +
  
  
  # mínimo
  geom_text_repel(
    data = g2_min,
    aes(label = scales::number(n,
                               scale = 1/1000,
                               decimal.mark = ",",
                               big.mark = ".",
                               accuracy = 0.01,
                               suffix = " mil")),
    nudge_x = -0.4,
    direction = "y",
    hjust = "right",
    size = 6
  ) +
  
  
  
  geom_label_repel(
    data = g2_2024,
    aes(label = stringr::str_wrap(cnae_2_subclasse_descricao_divisao, 30)),
    label.size = NA,
    size = 6,
    family="Helvetica",
    direction = "y",
    hjust = -.01,
    face = "bold",
    color = "black"
  ) +
  facet_grid(~id_municipio_nome) +
  bbc_style() +
  labs(title = "Vínculos do Setor Portuário e Aquaviário no País",
       subtitle = "Grupos com maior participação",
       caption = "Fonte: Observatório Portuário - Dados da RAIS 2024") +
  scale_y_continuous(labels = scales::label_number(scale = 1/1000)) +
  ggthemes::scale_color_gdocs() +
  scale_x_discrete(expand = expansion(mult = c(.1, .3))) +
  theme(
    legend.position = "none",
    axis.text.y = element_blank(),
    panel.grid.major.x = element_line(color = "black", linetype = "dotted", size = 0.1),
    panel.grid.major.y = element_line(color = "black", linetype = "dotted", size = 0.1)
  )

  
```

```{r g_grupo, echo=FALSE, message=FALSE, warning=FALSE}

# manipulação dos dados. Grupos CNAE
grupo <- 
  manipulacao(
    dataset = rais, 
    nivel1 = cnae_1_descricao_divisao, 
    nivel2 = cnae_1_descricao_grupo
  )




#grafico
a <- 
grafico(
  dataset = grupo,
  nivel1 = cnae_1_descricao_divisao, 
  nivel2 = cnae_1_descricao_grupo, 
  titulo = "Vínculos de Emprego por Grupo de Atividade Econômica"
  )+
  bbc_style()+
  labs(caption = "Fonte: Observatório Portuário - Dados da RAIS 2024")+
  theme(
    plot.subtitle= element_blank(), 
            legend.text = element_text(size = 12), 
    panel.grid.major.x  = element_line(color = "black", linetype = "dotted", size = 0.1),
    panel.grid.major.y  = element_line(color = "black", linetype = "dotted", size = 0.1),
       legend.position = "top",
       legend.justification = c("left", "top"),
       legend.title = element_text(size = 10, face = "bold"), 
    strip.text.x = element_text(size=14, face = "bold"),
    strip.background = element_blank()
  ) +
  guides(
    color = guide_legend(
      title = "",
      ncol = 2, keywidth = unit(1.5, "cm"))) +
  ggthemes::scale_fill_gdocs()


print(a)
```

<br>

<br>

Esses dados podem detalhados um pouco mais a partir da análise das seções da Classificação Nacional de Atividades Econômicas (CNAE) do Instituto Brasileiro de Geografia e Estatística (IBGE), o que permite identificar quais áreas impactaram diretamente o estoque de empregos na área portuária e aquaviária.

Pelo gráfico a seguir, alguns destaques do setor podem ser obtidos por grupo de atividade (definições de cada categoria no glossário):

-   Ao considerar a **Gestão de Portos e Terminais**, o destaque foi para as *Operações de Terminais*, que apresentou número crescente de vínculos entre 2020 e 2024, registrando 35.357 vínculos. Por outro lado, as atividades de Administração da Infra-estrutura Portuária tiveram um declínio de 41,25%, resultado da destruição de 2.170 vínculos .

São atividades como *as atividades da administração da estrutura portuária, tais como o balizamento da área portuária, a manutenção da dragagem e das condições físicas do porto*, a*s atividades de operação de terminais marítimos e fluviais, de uso público ou privado*, *o armazenamento no parque portuário de mercadorias provenientes ou destinadas às embarcações* e *a operação e gestão de equipamentos destinados a carga e descarga*, bem como *a carga e descarga de embarcações*, não ficando de fora as atividades realizadas pelos operadores portuários.

-   O **Transporte Marítico de Carga por Cabotagem**, por sua vez, teve uma redução drástica de vínculos: saiu de 8.289 em 2020 para 3.316 em 2024.

Trata-se, portanto, de atividades como o transporte marítimo de carga realizado entre portos ou pontos do território brasileiro utilizando a via marítima, incluindo o fretamento de embarcações com tripulação para o transporte de cabotagem de carga.

-   O **Transporte por Navegação Interior de Carga**, por outro lado, apresentou leve aumento: passou de 7.524 para 8.382 vínculos. Essa categoria abarca as atividades de *transporte de carga por rios, canais, lagos, lagoas, baías e outras vias de navegação interior, em percurso nacional ou internacional*.

-   A **Navegação de Apoio Marítimo**, por sua vez, duplicou o número de vínculos e chegou a 15.372 profissionais na área. Isso significa que são profissionais que atuam em atividades de *navegação realizada para o apoio logístico a embarcações e instalações em águas territoriais nacionais e na Zona Econômica, que atuem nas atividades de pesquisa de minerais e hidrocarbonetos*.

```{r  g_classe, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE, fig.height=14, fig.width=14}
# manipulação dos dados
classe <- 
  manipulacao(
    dataset = rais, 
    nivel1 = cnae_1_descricao_grupo, 
    nivel2 = cnae_2_subclasse_descricao_classe
  )


#grafico
a <- 
classe |> 
grafico(
  nivel1 = cnae_1_descricao_grupo, 
  nivel2 = cnae_2_subclasse_descricao_classe, 
  titulo = "Vínculos profissionais por setor de atuação"
  )+
  bbc_style()+
  labs(color = "") +
  theme(
    plot.subtitle= element_blank(), 
    legend.text = element_text(size = 12), 
    panel.grid.major.x  = element_line(color = "black", linetype = "dotted", size = 0.1),
    panel.grid.major.y  = element_line(color = "black", linetype = "dotted", size = 0.1),
       legend.position = "top",
       legend.justification = c("left", "top"),
       legend.title = element_text(size = 10, face = "bold"), 
    strip.text.x = element_text(size=12),
    strip.background = element_blank()
      
  ) +
  guides(
    color = guide_legend(
      ncol = 2, keywidth = unit(1.5, "cm"))) +
      scale_colour_discrete(labels = label_wrap_gen(width = 18)) 


print(a)


```

```{r funcao2, echo=FALSE, message=FALSE, warning=FALSE}
#| fig-width: 14
#| fig-height: 10
#| out-width: "100%"


# install.packages("ggthemes")

subclasse <- 
  manipulacao(
    dataset = rais, 
    nivel1 = cnae_2_subclasse_descricao_classe, 
    nivel2 = cnae_2_subclasse_descricao_subclasse
  )

#grafico
a <- 
subclasse |> 
grafico(
  nivel1 = cnae_2_subclasse_descricao_classe, 
  nivel2 = cnae_2_subclasse_descricao_subclasse, 
  titulo = ""
  ) + 
  labs(color = "") +
  #bbc_style()+
  theme(
    plot.subtitle= element_blank(), 
    legend.text = element_text(size = 12), 
    panel.grid.major.x  = element_line(color = "black", linetype = "dotted", size = 0.1),
    panel.grid.major.y  = element_line(color = "black", linetype = "dotted", size = 0.1),
    legend.position = "top",
    legend.justification = c("left", "top"),
    #legend.title = element_text(size = 10, face = "bold"), 
    strip.text.x = element_text(size=12, face = "bold"),
    strip.background = element_blank()) +
    ggthemes::scale_color_stata() +
    guides(color = guide_legend(ncol = 3, keywidth = unit(1.5, "cm"))) 



print(a)

```

<br> Os dados são um reflexo das políticas de regulação para o setor, evidenciando como as estratégias governamentais e empresariais se refletem no estoque de empregos no setor.

Na próxima seção os dados para Santos são apresentados.

# Panorama do trabalho no setor portuário e aquaviário em Santos

Ao analisar os dados para o estado do Maranhão, verifica-se que os vínculos diretos foram ascendentes até o ano de 2017, quando foram identificados 2.016 vínculos. Em 2024, depois de quedas em 2018 e 2019, apresentou ligeira recuperação e o número de vínculos registrados foi de 1.924.

```{r g_secao_ma,  echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
g1<-
  rais |>
  filter(id_municipio_nome == "Santos") |> 
  group_by(ano, cnae_2_subclasse_descricao_secao) |> 
  summarise(n = n()) |> 
  mutate(ano = factor(ano, lvls_ano))


g1 |> 
ggplot(aes(x = ano, y = n, group = cnae_2_subclasse_descricao_secao)) +
  geom_line(aes(color = cnae_2_subclasse_descricao_secao), size = 2) +
  geom_point(color = "black", size = 4) +
  ggrepel::geom_text_repel(aes(x = ano, y = n, label = scales::number(n, decimal.mark = ",", big.mark = ".")), nudge_x = -0.2, direction = "y", hjust = "right", size = 4) +
  labs(x = "Ocupação", y = "Número de vínculos (em mil)",
       title = "Vínculos do Setor Portuário e aquaviário no Maranhão (2020 - 2024)", subtitle = "Seção da CNAE H",
         caption = "Fonte: Observatório Portuário - Dados da RAIS") +
    bbc_style() +
  labs(
       title = "Vínculos do Setor Portuário e Aquaviário no Maranhão", 
       subtitle = "Grupos com maior participação",
         caption = "Fonte: Observatório Portuário - Dados da RAIS") +
  scale_colour_discrete(
      name = "", 
      labels = label_wrap_gen(width = 35)) +
    ggthemes::scale_color_gdocs() +
  scale_y_continuous(labels = label_number(scale = 1/1000)) +
  theme(legend.position = "none",
        panel.grid.major.x  = element_line(color = "black", linetype = "dotted", size = 0.1),
    panel.grid.major.y  = element_line(color = "black", linetype = "dotted", size = 0.1),
        axis.text.y = element_blank())
```

<br>

No caso do Maranhão, o **Transporte Aquaviário** é o grupo de atividade que apresenta o maior número de empregos diretos, com 1.000 vínculos em 2024.

Ao mesmo tempo, as atividades abarcadas pelo **Armazenamento e Atividades Auxiliares dos Transportes** apresentaram permanente crescimento no perído, o que se relaciona com o aumento das atividades portuárias no estado,com o registro de 920 vínculos em 2024.

<br>

```{r g_divisao_ma,  echo=FALSE, message=FALSE, warning=FALSE, results='hide', fig.height=14, fig.width=12}

g2 <- rais |>
  filter(!is.na(cnae_1_descricao_divisao) & id_municipio_nome == "Santos") |> 
  group_by(ano, cnae_1_descricao_divisao) |>
  summarise(n = n(), .groups = "drop") |>
  mutate(ano = factor(ano, lvls_ano))

# Dados para rótulos finais (somente 2024)
g2_2024 <- g2 |> filter(ano == "2024")

ggplot(g2, aes(x = ano, y = n, group = cnae_1_descricao_divisao, color = cnae_1_descricao_divisao)) +
  geom_line(size = 2) +
  geom_point(color = "black", size = 3) +
  geom_text_repel(
    aes(label = scales::number(n, decimal.mark = ",", big.mark = ".")),
    nudge_x = -0.2,
    direction = "y",
    hjust = "right",
    size = 4
  ) +
  geom_label_repel(
    data = g2_2024,
    aes(label = stringr::str_wrap(cnae_1_descricao_divisao, 22)),
    label.size = NA,
    family = "Helvetica",
    direction = "y",
    hjust = -.01,
    face = "bold"
  ) +
  bbc_style() +
  labs(
    title = "Vínculos do Setor Portuário e Aquaviário no Maranhão",
    subtitle = "Em mil",
    caption = "Fonte: Observatório Portuário - Dados da RAIS 2024"
  ) +
  scale_x_discrete(expand = expansion(mult = c(.1, .3))) +
  ggthemes::scale_color_gdocs() +
  theme(
    legend.position = "none",
    legend.text = element_text(size = 12),
    panel.grid.major.x = element_line(color = "black", linetype = "dotted", size = 0.1),
    panel.grid.major.y = element_line(color = "black", linetype = "dotted", size = 0.1)
  )
```

<br>

No gráfico a seguir pode-se observar as modalidades abarcadas pelo **Transporte Aquaviário** e suas representatividades no estado. O destaque positivo é para o setor de **Navegação de Apoio**, que auxilia as atividades portuárias.

<br>

```{r g_grupo_ma, echo=FALSE, message=FALSE, warning=FALSE}

# manipulação dos dados. Grupos CNAE
grupo_ma <- rais |> filter(id_municipio_nome == "Santos")

grupo_ma.2 <- 
  manipulacao(
    dataset = grupo_ma, 
    nivel1 = cnae_1_descricao_divisao, 
    nivel2 = cnae_2_subclasse_descricao_grupo
  )

#grafico
a.ma <- 
grafico(
  dataset = grupo_ma.2,
  nivel1 = cnae_1_descricao_divisao, 
  nivel2 = cnae_2_subclasse_descricao_grupo, 
  titulo = "Vínculos por setor no Santos"
  )+
  labs(color = "") +
  bbc_style()+
  theme(plot.subtitle= element_blank(), 
            legend.text = element_text(size = 12), 
    panel.grid.major.x  = element_line(color = "black", linetype = "dotted", size = 0.1),
    panel.grid.major.y  = element_line(color = "black", linetype = "dotted", size = 0.1),
       legend.position = "top",
       legend.justification = c("left", "top"),
       legend.title = element_text(size = 10, face = "bold"), 
    strip.text.x = element_text(size=12, face = "bold"),
    strip.background = element_blank()) +
  ggthemes::scale_color_gdocs() +
  guides(color = guide_legend(ncol = 3, keywidth = unit(1.5, "cm"))) 
  #scale_colour_discrete(name = str_wrap("Grupos da CNAE", 10), labels = label_wrap_gen(width = 30)) 

print(a.ma)
```

<br>

Ao analisar as subclasses de atividade, pode-se verificar que as atividades relacionadas a **Operações de Terminais** teve excelente resultado, saltando de 14 para 920 mil vínculos, o que indica uma transformação estrutural nas atividades.

A **Navegação de Apoio Marítimo** e **Navegação de Apoio Portuário** também se destacam, embora com oscilações consideráveis na série.

<br>

```{r subclasse.ma, echo=FALSE, message=FALSE, warning=FALSE, fig.height=14, fig.width=14}


subclasse.ma <- 
  manipulacao(
    dataset = grupo_ma, 
    nivel1 = cnae_2_subclasse_descricao_classe, 
    nivel2 = cnae_2_subclasse_descricao_subclasse
  )

#grafico
a_ma_subclasse <- 
subclasse.ma |> 
grafico(
  nivel1 = cnae_2_subclasse_descricao_classe, 
  nivel2 = cnae_2_subclasse_descricao_subclasse, 
  titulo = ""
  )+ theme(plot.subtitle= element_blank(), 
            legend.text = element_text(size = 12), 
    strip.text.x = element_text(size=14, face = "bold"                                   ),
    strip.background = element_blank(),
    legend.title = element_blank()) +
      scale_colour_discrete(
      name = "", 
      ) +
    guides(color = guide_legend(ncol = 1, keywidth = unit(1.5, "cm"))) +
  ggthemes::scale_color_stata() 


print(a_ma_subclasse)

```

# Perfil do Trabalhador Portuário e Aquaviário

#### Escolaridade do Trabalhador Portuário e aquaviário

Ao analisar o perfil dos trabalhadores portuários e aquaviários por sexo, observa-se que a participação masculina é predominante. Em 2024, do total de 76.317 vínculos, 65.735 eram homens, sendo apenas 10.582 mulheres (13,87%).

No Maranhão a proporção é igual: dos 1.924 vínculos, apenas 14% eram mulheres (2.629)

Apesar da baixa participação feminina no setor, observa-se que elas apresentavam maior escolaridade no contexto nacional: 44,5% tinham curso superior, contra 17,7% dos homens com a mesma escolaridade. De forma agregada, observa-se o aumento da escolarização entre 2020 e 2024, apesar do número de profissionais com pós-graduação ainda ser baixo.

Em 2024, a quantidade de ocupações que exigiam o **ensino médio completo** era de 58,57% (desses, 91,25% eram do sexo masculino e apenas 8,75% do sexo feminino), por outro lado, 21,4% das ocupações exigiam o **Superior completo** (desses, 71,19% eram do sexo masculino e 28,81% do sexo feminino)

<br>

```{r g_operacao_escol_sexo, results='hide', echo=FALSE, message=FALSE, warning=FALSE}
# ordem_esc <- c("Fundamental incompleto", "Fundamental completo", 
#         "Médio incompleto", "Médio completo", "Superior incompleto",
#         "Superior completo", "Pós-graduação", "Não informado")

escolaridade <- 
manipulacao(
    dataset = rais, 
    nivel1 = sexo, 
    nivel2 = grau_instrucao_apos_2005)



#grafico
a <- 
escolaridade |> 
grafico(
  nivel1 = sexo, 
  nivel2 = grau_instrucao_apos_2005, 
  titulo = "Vínculos por grau de escolaridade e sexo no país")+
  ggthemes::scale_color_gdocs() +
  scale_y_continuous(labels = label_number(scale = 1/1000)) +
  theme(
    strip.text.x = element_text(size=14, face = "bold"),
    strip.background = element_blank(),
    legend.title = element_blank()) 
  

print(a)


```

<br>

O Maranhão também acompanha a tendência nacional no quesito escolarização: há o predomínio de profissionais com ensino médio completo e, em seguida, ensino superior. Apesar de crescente, o número de pessoas com pós-graduação ainda é incipiente, como se observa no gráfico:

<br>

```{r g_operacao_escol_sexo.ma, results='hide', echo=FALSE, message=FALSE, warning=FALSE}
# ordem_esc <- c("Fundamental incompleto", "Fundamental completo", 
#         "Médio incompleto", "Médio completo", "Superior incompleto",
#         "Superior completo", "Pós-graduação", "Não informado")

escolaridade.ma <- 
manipulacao(
    dataset = grupo_ma, 
    nivel1 = sexo, 
    nivel2 = grau_instrucao_apos_2005)



#grafico
grafico.escolaridade.ma <- 
escolaridade.ma |> 
grafico(
  nivel1 = sexo, 
  nivel2 = grau_instrucao_apos_2005, 
  titulo = "Vínculos por grau de escolaridade e sexo no Maranhão"
         )+
  theme(
    strip.text.x = element_text(size=14, face = "bold"),
    strip.background = element_blank(),
    legend.title = element_blank()) +
  ggthemes::scale_color_gdocs()

print(grafico.escolaridade.ma)


```

<br>

Ao avaliar a remuneração média por escolaridade no país, verifica-se que os profissionais com pós-graduação têm uma renda significativamente superior aos demais níveis de escolaridade.

<br>

```{r g_remun_escol_sexo,results='hide', echo=FALSE, message=FALSE, warning=FALSE}
df_plot <- rais |> 
  filter(valor_remuneracao_media != 0.00 | !is.na(valor_remuneracao_media)) |>
  group_by(sexo, grau_instrucao_apos_2005, ano) |> 
  summarise(remuneracao_media = mean(valor_remuneracao_media), .groups = "drop") |> 
  mutate(ano = factor(ano, lvls_ano))

df_points <- df_plot |> filter(ano %in% c("2020", "2024"))


ggplot(df_plot,
       aes(x = ano, 
           y = remuneracao_media, 
           group = grau_instrucao_apos_2005, 
           color = grau_instrucao_apos_2005)) +
  geom_line(size = 2) +
  geom_point(data = df_points, color = "black", size = 3) +
  geom_text_repel(
    data = df_points,
    aes(
      label = scales::number(
        remuneracao_media,
        scale = 1/10^3,
        accuracy = 0.01,
        suffix = " mil",
        decimal.mark = ",",
        big.mark = ".")
    ),
    size = 5,
    min.segment.length  =  0.5,
    box.padding  =  1,
    force = 8
  ) +
  labs(x = "Ano", y = "Remuneração média (R$)", color = "",
       title = "Remuneração Média por sexo e grau de instrução no país",
       caption = "Fonte: Observatório Portuário - Dados da RAIS") +
  facet_wrap(~sexo, ncol = 2) +
  theme_classic() +
  theme(
    plot.title = element_text(size = 16L, face = "bold"),
    plot.caption = element_text(size = 12L, face = "bold", hjust = 0),
    axis.title.y = element_text(size = 14L, face = "bold"),
    axis.title.x = element_text(size = 14L, face = "bold"),
    axis.text.x = element_text(size = 12L, face = "bold"),
    axis.text.y = element_text(size = 12L, face = "bold"),
    legend.text = element_text(size = 10L),
    panel.grid.major.x = element_line(color = "black", linetype = "dotted", size = 0.1),
    panel.grid.major.y = element_line(color = "black", linetype = "dotted", size = 0.1),
    legend.position = "top",
    legend.title = element_text(size = 16L, face = "bold"),
    legend.key.width = unit(1.5, "cm"),
    legend.key.height = unit(.5, "cm"),
    strip.text.x = element_text(size = 14, face = "bold"),
    strip.background = element_blank()
  ) +
  guides(col = guide_legend(nrow = 2)) +
  ggthemes::scale_color_gdocs()
 

```

<br>

A renda do trabalhador maranhense segue a tendência nacional: profissional com pós-graduação aufere rendimentos bem superiores aos dos demais profissionais.

<br>

```{r g_remun_escol_sexo.ma,results='hide', echo=FALSE, message=FALSE, warning=FALSE}

grupo_ma |> 
  filter(!is.na(valor_remuneracao_media), valor_remuneracao_media > 0) |>
  group_by(sexo, grau_instrucao_apos_2005, ano) |> 
  summarise(remuneracao_media = mean(valor_remuneracao_media), .groups = "drop") |> 
  mutate(ano = factor(ano, lvls_ano)) |>
  ggplot(aes(x = ano, 
             y = remuneracao_media, 
             group = grau_instrucao_apos_2005, 
             color = grau_instrucao_apos_2005)) +
  geom_line(size = 1.8) +
  geom_point(data = ~subset(.x, ano %in% c("2020", "2024")),
             color = "black", size = 3) +
  geom_text_repel(
      data = ~subset(.x, ano %in% c("2020", "2024")),
      aes(label = scales::number(remuneracao_media,
                                 scale = 1/1000,
                                 accuracy = 0.01,
                                 suffix = " mil",
                                 decimal.mark = ",",
                                 big.mark = ".")),
      size = 4.2,
      min.segment.length = 0.3,
      box.padding = 0.5,
      force = 6
  ) +
  labs(
    x = "Ano",
    y = "Remuneração média (R$)",
    color = "Grau de instrução",
    title = "Remuneração Média por sexo e grau de instrução no Maranhão",
    caption = "Fonte: Observatório Portuário - Dados da RAIS"
  ) +
  facet_wrap(~sexo, ncol = 2) +
  theme_classic() +
  theme(
    plot.title = element_text(size = 16, face = "bold"),
    plot.caption = element_text(size = 11, hjust = 0),
    axis.title = element_text(size = 14, face = "bold"),
    axis.text = element_text(size = 11, face = "bold"),
    panel.grid.major.x = element_line(color = "black", linetype = "dotted", size = 0.1),
    panel.grid.major.y = element_line(color = "black", linetype = "dotted", size = 0.1),
    legend.position = "top",
    legend.text = element_text(size = 10),
    legend.title = element_text(size = 12, face = "bold"),
    strip.text.x = element_text(size = 14, face = "bold"),
    strip.background = element_blank()
  ) +
  guides(col = guide_legend(nrow = 2)) +
  scale_color_discrete(labels = label_wrap_gen(width = 28))

 

```

#### Raça ou cor do Trabalhador Portuário e Aquaviário

O perfil racial dos profissionais pode ser observado no gráfico a seguir[^1]. Nota-se o predomínio de pardos e brancos, tanto entre os homens como entre as mulheres.

[^1]: Como há uma discrepância da quantidade de vínculos das categorias de **raça ou cor** quando comparadas por **sexo**, optou-se pela **escala logarítmica** no lugar da escala aritimética (escala habitual nos gráficos) para representar os dados quantidade de vínculos (**eixo y**) , pois a logarítmica permite, no caso do gráfico abaixo, uma visualização das tendências das quantidades de vínculos por cada raça ou cor ao longo dos anos analisados.

Destaca-se ainda o alto registro da ausência de identificação racial nos dados, o que é pauta para as ações de sensibilização dos profissionais de gestão com pessoas e alinhado às ações de Governança Social. O correto preenchimento dos dados pode auxiliar políticas de inclusão, qualificação e diversidade mais assertivas.

```{r g_operacao_raca_sexo, results='hide', echo=FALSE, message=FALSE, warning=FALSE}
dados <- rais |>
  group_by(ano, raca_cor, sexo) |>
  summarise(n = n(), .groups = "drop") |>
  mutate(raca_cor = forcats::fct_reorder(raca_cor, n),
         ano = factor(ano, lvls_ano))

dados_label <- dados |> filter(ano %in% c("2020", "2024"))



dados |> 
  ggplot(aes(x =ano, y = n, group = raca_cor, color = raca_cor)) +
   geom_line(size = 2) +
  geom_point(
    data = dados_label |> filter(ano %in% c("2020", "2024")),
      aes(x = ano, y = n), 
      color = "black", size = 5,
    show.legend = F) +
   geom_text_repel(
      data = dados_label |> filter(ano %in% c("2020", "2024")),
      aes(
        x = ano, y = n,
        label = scales::number(
          n,
          scale = 1/10^3,
          accuracy = 0.01,
          suffix = " mil",
          decimal.mark = ",",
          big.mark = "."),
        ),
      size = 5,
      min.segment.length  =  0.5,
      box.padding  =  1,
      force = 8,
    ) +
  # scale_y_log10(labels = label_number(scale = 1/10^3,
  #           suffix = " mil",
  #           accuracy = 0.1,
  #           decimal.mark = ",",
  #           big.mark = ".")) +
  # scale_y_continuous(
  #   labels = label_number(scale = 1/1000, big.mark = ".", decimal.mark = ",")) +
    labs(x = "Ano", y = "Número de Vínculos", color = "Raça ou cor",
         caption = "Fonte: Observatório Portuário - Dados da RAIS") +
  facet_wrap(~sexo,ncol = 2)+
  theme_classic() +
  theme(plot.title = element_text(size = 16L, face = "bold"),
        plot.caption = element_text(size = 12L,face = "bold", hjust = 0), 
        axis.title.y = element_text(size = 14L, face = "bold"), 
        axis.title.x = element_text(size = 14L, face = "bold"),
        axis.text.x = element_text(size = 12L, face = "bold"),
        axis.text.y = element_text(size = 12L, face = "bold"),
        #tema legenda
        legend.text = element_text(size = 14L),
       panel.grid.major.x  = element_line(color = "black", linetype = "dotted", size = 0.1),
    panel.grid.major.y  = element_line(color = "black", linetype = "dotted", size = 0.1),
        legend.position = "top",
        legend.justification = c("top"),
        legend.title = element_text(size = 16L, face = "bold"),
        #legend.background = element_rect(fill = "white", colour = "black"),
        legend.key.width = unit(1.5, "cm"),
        legend.key.height = unit(.25, "cm"),
        strip.text.x = element_text(size=14, face = "bold"                                   ),
    strip.background = element_blank()
        #
  ) +
  guides(
    col = guide_legend(nrow = 2)) +
  ggthemes::scale_color_gdocs()
  #bbc_style()
 
```

Apesar da destacada participação de pardos, a remuneração média desses profissionais em 2024 era inferior a dos brancos. Nota-se que homens e mulheres brancos tiveram a renda constante e crescente na série, mantendo a assimetria em relação aos pretos e pardos.

<br>

```{r g_operacao_remuneracao_raca_sexo, results='hide', echo=FALSE, message=FALSE, warning=FALSE, include=TRUE}

# Primeiro, crie o dataframe processado separadamente
dados_processados <- rais |>
  filter(valor_remuneracao_media != 0.00 & !is.na(valor_remuneracao_media)) |>  # Mudado para &
  group_by(ano, raca_cor, sexo) |> 
  summarise(n = n(),
            media = mean(valor_remuneracao_media),
            .groups = 'drop') |>
  mutate(ano = factor(ano, lvls_ano))



# Se sexo existir, crie o gráfico
ggplot(dados_processados, aes(x = ano, y = media, group = raca_cor, color = raca_cor)) +
  geom_line(size = 2) +
  geom_point(
    data = dados_processados |> filter(ano %in% c(2020, 2024)),
    aes(x = ano, y = media), 
    color = "black", size = 5,
    show.legend = FALSE
  ) +
  geom_text_repel(
    data = dados_processados |> filter(ano %in% c(2020, 2024)),
    aes(
      label = scales::number(
        media,
        scale = 1/10^3,
        accuracy = 0.01,
        suffix = " mil",
        decimal.mark = ",",
        big.mark = "."
      )
    ),
    size = 5,
    min.segment.length = 0.5,
    box.padding = 1,
    force = 8
  ) +
  labs(
    x = "Ano", 
    y = "Remuneração média (R$)", 
    color = "Raça ou cor",
    caption = "Fonte: Observatório Portuário - Dados da RAIS"
  ) +
  facet_wrap(~sexo, ncol = 2) +  # Verifique se esta variável existe
  theme_classic() +
  theme(
    plot.title = element_text(size = 16, face = "bold"),
    plot.caption = element_text(size = 12, face = "bold", hjust = 0), 
    axis.title.y = element_text(size = 14, face = "bold"), 
    axis.title.x = element_text(size = 14, face = "bold"),
    axis.text.x = element_text(size = 12, face = "bold"),
    axis.text.y = element_text(size = 12, face = "bold"),
    legend.text = element_text(size = 14),
    panel.grid.major.x = element_line(color = "black", linetype = 3, size = 0.1),
    legend.position = "top",
    legend.justification = "top",
    legend.title = element_text(size = 16, face = "bold"),
    legend.key.width = unit(1.5, "cm"),
    legend.key.height = unit(1.5, "cm"),
    strip.text.x = element_text(size = 14, face = "bold"),
    strip.background = element_blank()
  ) +
  guides(col = guide_legend(nrow = 2)) +
  ggthemes::scale_color_gdocs()

```

```{r g_operacao_remuneracao _media_raca_sexo, results='hide', echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
# Processar os dados primeiro
dados_plot <- rais |>
  filter(valor_remuneracao_media != 0.00 | !is.na(valor_remuneracao_media)) |>
  group_by(ano, raca_cor, sexo) |> 
  summarise(n = n(),
            media = mean(valor_remuneracao_media),
            .groups = 'drop') |> 
  mutate(ano = factor(ano, lvls_ano))

# Verificar se os anos 2020 e 2024 existem nos dados
# print(unique(dados_plot$ano))

# Plotar
ggplot(dados_plot, aes(x = ano, y = media, group = raca_cor, color = raca_cor)) +
  geom_line(size = 2) +
  geom_point(
    data = dados_plot |> filter(ano %in% c("2020", "2024")),
    aes(x = ano, y = media), 
    color = "black", size = 5,
    show.legend = FALSE
  ) +
  geom_text_repel(
    data = dados_plot |> 
      filter(ano %in% c("2020", "2024")) |> 
      group_by(raca_cor, sexo),
    aes(
      x = ano, 
      y = media,  # CORREÇÃO: estava 'y = n', mas deve ser 'y = media'
      label = scales::number(
        media,
        scale = 1/10^3,
        accuracy = 0.01,
        suffix = " mil",
        decimal.mark = ",",
        big.mark = "."
      )
    ),
    size = 5,
    min.segment.length = 0.5,
    box.padding = 1,
    force = 8
  ) +
  labs(
    title = "Remuneração Média no Brasil por Cor ou Raça",
    x = "Ano", 
    y = "Remuneração média (R$)", 
    color = ""
  ) +
  facet_wrap(~sexo, ncol = 2) +
  theme_classic() +
  theme(
    plot.title = element_text(size = 16, face = "bold"),
    plot.caption = element_text(size = 12, face = "bold", hjust = 0), 
    axis.title.y = element_text(size = 14, face = "bold"), 
    axis.title.x = element_text(size = 14, face = "bold"),
    axis.text.x = element_text(size = 12, face = "bold"),
    axis.text.y = element_text(size = 12, face = "bold"),
    legend.text = element_text(size = 14),
    panel.grid.major.x = element_line(color = "black", linetype = "dotted", size = 0.1),
    panel.grid.major.y = element_line(color = "black", linetype = "dotted", size = 0.1),
    legend.position = "top",
    legend.justification = "top",
    legend.title = element_text(size = 16, face = "bold"),
    legend.key.width = unit(1.5, "cm"),
    legend.key.height = unit(1.5, "cm"),
    strip.text.x = element_text(size = 14, face = "bold"),
    strip.background = element_blank()
  ) +
  guides(col = guide_legend(nrow = 1)) +
  ggthemes::scale_color_gdocs()
```

No Maranhão, os profissionais identificados como pardos predominam, sendo seguidos pelos brancos e pretos entre os homens e mulheres.

```{r g_operacao_raca_sexo.ma, results='hide', echo=FALSE, message=FALSE, warning=FALSE}


# Processar os dados primeiro
dados_plot <- grupo_ma |>
  group_by(ano, raca_cor, sexo) |> 
  summarise(n = n(), .groups = 'drop') |> 
  mutate(raca_cor = forcats::fct_reorder(raca_cor, n)) |> 
  mutate(ano = factor(ano, lvls_ano))

# Verificar os anos disponíveis
# print(unique(dados_plot$ano))

# Criar dados para pontos e textos
pontos_data <- dados_plot |> filter(ano %in% c("2020", "2024"))
texto_data <- dados_plot |> filter(ano %in% c("2020", "2024"))

# Plotar
ggplot(dados_plot, aes(x = ano, y = n, group = raca_cor, color = raca_cor)) +
  geom_line(size = 2) +
  geom_point(
    data = pontos_data,
    aes(x = ano, y = n), 
    color = "black", size = 5,
    show.legend = FALSE
  ) +
  geom_text_repel(
    data = texto_data,
    aes(
      x = ano, y = n,
      label = scales::number(
        n,
        suffix = ""
      )
    ),
    size = 5,
    min.segment.length = 0.5,
    box.padding = 1,
    force = 8,
  ) +
  labs(
    title = "Número de Vínculos no Maranhão por cor ou Raça",
    x = "Ano", 
    y = "Número de Vínculos", 
    color = ""
  ) +
  scale_y_continuous(
    labels = scales::label_number(big.mark = ".", decimal.mark = ",")
  ) +
  facet_wrap(~sexo, ncol = 2) +
  theme_classic() +
  theme(
    plot.title = element_text(size = 16, face = "bold"),
    plot.caption = element_text(size = 12, face = "bold", hjust = 0), 
    axis.title.y = element_text(size = 14, face = "bold"), 
    axis.title.x = element_text(size = 14, face = "bold"),
    axis.text.x = element_text(size = 12, face = "bold"),
    axis.text.y = element_text(size = 12, face = "bold"),
    legend.text = element_text(size = 14),
    panel.grid.major.x = element_line(color = "black", linetype = "dotted", size = 0.1),
    panel.grid.major.y = element_line(color = "black", linetype = "dotted", size = 0.1),
    legend.position = "top",
    legend.justification = "top",
    legend.title = element_text(size = 16, face = "bold"),
    legend.key.width = unit(1.5, "cm"),
    legend.key.height = unit(1.5, "cm"),
    strip.text.x = element_text(size = 14, face = "bold"),
    strip.background = element_blank()
  ) +
  guides(col = guide_legend(nrow = 1)) +
  ggthemes::scale_color_gdocs()
```

A renda dos trabalhadores por cor ou raça no Maranhão, por sua vez, evidencia que os autodeclarados amarelos se destacam entre os homens, com remuneração média acima das demais (amarelos, de acordo com o IBGE, são aqueles que se declaram de origem asiática: japoneses, coreanos e chineses).

```{r g_operacao_remuneracao _media_raca_sexo.ma, results='hide', echo=FALSE, message=FALSE, warning=FALSE}

# PRIMEIRO: Criar o dataframe processado
dados_plot_ma <- grupo_ma |>
  filter(valor_remuneracao_media != 0.00 | !is.na(valor_remuneracao_media)) |>
  group_by(ano, raca_cor, sexo) |> 
  summarise(
    n = n(),
    media = mean(valor_remuneracao_media),
    .groups = 'drop'
  ) |>
  mutate(ano = factor(ano, lvls_ano))

# SEGUNDO: Criar os dataframes para pontos e textos
pontos_data_ma <- dados_plot_ma |> filter(ano %in% c(2020, 2024))
texto_data_ma <- dados_plot_ma |> 
  filter(ano %in% c(2020, 2024)) |> 
  group_by(raca_cor, sexo)

# TERCEIRO: Criar o gráfico
ggplot(dados_plot_ma, aes(x = ano, y = media, group = raca_cor, color = raca_cor)) +
  geom_line(size = 2) +
  geom_point(
    data = pontos_data_ma,
    aes(x = ano, y = media), 
    color = "black", size = 5,
    show.legend = FALSE
  ) +
  geom_text_repel(
    data = texto_data_ma,
    aes(
      label = scales::number(
        media,
        scale = 1/10^3,
        accuracy = 0.01,
        suffix = " mil",
        decimal.mark = ",",
        big.mark = "."
      )
    ),
    size = 5,
    min.segment.length = 0.5,
    box.padding = 1,
    force = 8,
  ) +
  labs(
    x = "Ano", 
    y = "Remuneração média (R$) no MA por raça ou cor", 
    color = "",
    caption = "Fonte: Observatório Portuário - Dados da RAIS"
  ) +
  facet_wrap(~sexo, ncol = 2) +
  theme_classic() +
  theme(
    plot.title = element_text(size = 16, face = "bold"),
    plot.caption = element_text(size = 12, face = "bold", hjust = 0), 
    axis.title.y = element_text(size = 14, face = "bold"), 
    axis.title.x = element_text(size = 14, face = "bold"),
    axis.text.x = element_text(size = 12, face = "bold"),
    axis.text.y = element_text(size = 12, face = "bold"),
    legend.text = element_text(size = 14),
    panel.grid.major.x = element_line(color = "black", linetype = 3, size = 0.1),
    legend.position = "top",
    legend.justification = "top",
    legend.title = element_text(size = 16, face = "bold"),
    legend.key.width = unit(1.5, "cm"),
    legend.key.height = unit(1.5, "cm"),
    strip.text.x = element_text(size = 14, face = "bold"),
    strip.background = element_blank()
  ) +
  guides(col = guide_legend(nrow = 1)) +
  ggthemes::scale_color_gdocs()
```

## Ocupações dos Trabalhadores Portuários e Aquaviários

As ocupações com maior participação no setor estão no gráfico a seguir, bem como a remuneração média respectiva.

Verifica-se que os profissionais *Marinheiros de Convés (martítimo e fluvial)* representam o maior contingente de profisisionais ao longo do período analisado, embora com tendência decrescente e em número inferior ao registrado em 2020.

São profissionais que, de acordo com o Códico Brasileiro de Ocupações (CBO), *comandam e imediatam pequenas embarcações, auxiliando o comandante na admi nistração de bordo e no serviço de manobras; chefiam praça de máquinas; transportamcargas e passageiros; realizam manobras, serviços e manutenção no convés; operammáquinas; realizam manutenção preventiva e corretiva da praça de máquinas e apli cam procedimentos de segurança*.

Por usa vez, os Assistentes Administrativos mantiveram uma estabilidade no número de vínculos, registrando cerca de 3.500 profissionais em 2024.

```{r g_operacao_ocupacao, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
# PRIMEIRO: Criar o dataframe processado
dados_cbo <- rais |>
  group_by(ano, cbo_2002_descricao) |> 
  summarise(n = n(), .groups = 'drop') |> 
  mutate(ano = factor(ano, lvls_ano))

# SEGUNDO: Selecionar as top 5 ocupações por ano
dados_top5 <- dados_cbo |>
  group_by(ano) |>
  slice_max(n, n = 5) |>
  ungroup() |>
  arrange(n)

# Verificar os anos disponíveis
print(unique(dados_top5$ano))

# SEGUNDO: Criar os dataframes para pontos e textos
pontos_data <- dados_top5 |> filter(ano %in% c("2020", "2024"))
texto_data <- dados_top5 |> filter(ano %in% c("2020", "2024"))

# TERCEIRO: Criar o gráfico
ggplot(dados_top5, aes(x = ano, y = n, group = cbo_2002_descricao, color = cbo_2002_descricao)) +
  geom_line(size = 2) +
  geom_point(
    data = pontos_data,
    color = "black", size = 3
  ) +
  geom_text_repel(
    data = texto_data,
    aes(
      x = ano, 
      y = n,
      label = scales::number(n, suffix = "")
    ), 
    nudge_x = -0.2, 
    direction = "both", 
    hjust = "right", 
    size = 5
  ) +
  scale_y_continuous(
    labels = scales::label_number(
      scale = 1/1000, 
      big.mark = ".", 
      decimal.mark = ",",
      prefix = ""
    )
  ) +
  theme_classic() +
  theme(
    plot.title = element_text(
      family = "Helvetica", size = 28, 
      face = "bold", color = "#222222"
    ), 
    plot.subtitle = element_text(
      family = "Helvetica", size = 22, 
      margin = margin(9, 0, 9, 0)
    ),
    plot.caption = element_text(size = 12, face = "bold", hjust = 0), 
    axis.title.y = element_text(size = 14, face = "bold"), 
    axis.title.x = element_text(size = 14, face = "bold"),
    axis.text.x = element_text(size = 12, face = "bold"),
    axis.text.y = element_text(size = 12, face = "bold"),
    legend.text = element_text(size = 18),
    panel.grid.major.x = element_line(color = "black", linetype = 3, size = 0.1),
    panel.grid.major.y = element_line(color = "black", linetype = 3, size = 0.1),
    legend.position = "top",
    legend.justification = c("left", "top"),
    legend.title = element_text(size = 16, face = "bold"),
    strip.text.x = element_text(size = 14, face = "bold"),
    strip.background = element_blank()
  ) +
  labs(
    x = "Ano", 
    y = "Número de vínculos", 
    color = "",
    title = "Ocupações que mais empregam dos setores Portuário e\nAquaviário (2020 - 2024)",
    caption = "Fonte: Observatório Portuário - Dados da RAIS"
  ) +
  ggthemes::scale_color_gdocs() +
  guides(
    color = guide_legend(
      ncol = 2, 
      keywidth = unit(1.5, "cm"),
      override.aes = list(size = 3)
    )
  )

 
  
```

## Remuneração dos Trabalhadores nos Estados

Verifica-se que a remuneração média dos trabalhadores portuários e aquaviários varia conforme o estado da federação. O Rio de Janeiro é o estado com a maior remuneração no período analisado, com o registro de R\$ 8.5345 em 2024. O Espírito Santo aparece em segundo lugar, com R\$ 6.112.

O estado do Maranhão teve uma evolução signifitiva no valor da remuneração média: saltou de R\$ 2.090 em 2020 para R\$ 4.765 em 2024.

```{r g_operacao_estado_rem, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
# Definir os estados com maiores remunerações em 2024
lvls_estado <- rais |> 
  group_by(ano, id_municipio_nome) |> 
  filter(valor_remuneracao_media != 0.00 | !is.na(valor_remuneracao_media)) |>
  summarise(media = mean(valor_remuneracao_media), .groups = 'drop') |> 
  filter(ano == 2024) |> 
  slice_max(media, n = 7) |> 
  pull(id_municipio_nome)

# Criar o dataframe processado
dados_estados <- rais |> 
  filter(valor_remuneracao_media != 0.00 | !is.na(valor_remuneracao_media)) |>
  group_by(ano, id_municipio_nome) |> 
  summarise(media = mean(valor_remuneracao_media), .groups = 'drop') |> # média
  mutate(ano = factor(ano, lvls_ano)) |>
  filter(id_municipio_nome %in% lvls_estado)

# Criar dataframes para pontos e textos
pontos_estados <- dados_estados |> 
  filter(ano %in% c("2020", "2024"))

texto_estados <- dados_estados |> 
  filter(ano %in% c("2020", "2024"))

# Criar o gráfico
ggplot(dados_estados, aes(x = ano, y = media, group = id_municipio_nome, color = id_municipio_nome)) +
  geom_line(size = 2) +
  geom_point(
    data = pontos_estados,
    aes(x = ano, y = media), 
    color = "black", size = 5
  ) +
  geom_text_repel(
    data = texto_estados,
    aes(
      x = ano, 
      y = media,
      label = scales::number(
        media, 
        decimal.mark = ",", 
        big.mark = ".", 
        prefix = "R$",
        suffix = " "
      )
    ), 
    nudge_x = -0.2, 
    direction = "both", 
    hjust = "right", 
    size = 4, 
    vjust = 1
  ) +
  scale_y_continuous(
    labels = scales::label_number(big.mark = ".", decimal.mark = ",")
  ) +
  theme_classic() +
  theme(
    plot.title = element_text(size = 16, face = "bold"),
    plot.caption = element_text(size = 12, face = "bold", hjust = 0), 
    axis.title.y = element_text(size = 14, face = "bold"), 
    axis.title.x = element_text(size = 14, face = "bold"),
    axis.text.x = element_text(size = 12, face = "bold"),
    axis.text.y = element_text(size = 12, face = "bold"),
    legend.text = element_text(size = 14),
    panel.grid.major.x = element_line(color = "black", linetype = 3, size = 0.1),
    legend.position = "top",
    legend.justification = c("left", "top"),
    legend.title = element_text(size = 16, face = "bold")
  ) +
  labs(
    title = "Estados com maiores remunerações",
    x = "Ano", 
    y = "Remuneração média", 
    color = "",
    caption = "Fonte: Observatório Portuário - Dados da RAIS"
  ) +
  ggthemes::scale_color_gdocs() +
  guides(color = guide_legend(nrow = 1, keywidth = unit(1.5, "cm")))

  
```

## Remuneração dos Trabalhadores nos municípios

Ao analisar a remuneração média por município, o destaque positivo fica com os município de Macaé, Rio de Janeiro, São João da Barra e Itajaí que pagam as maiores remunerações, acima de 8 mil reais. No entanto, Macaé possui uma remuneração média superior ao segundo colocado em quase 3 mil reais.

```{r g_operacao_municipio, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
lvls_municipio <- 
rais |> 
  group_by(ano, id_municipio_nome) |>
  filter(
    valor_remuneracao_media != 0.00 | 
      !is.na(valor_remuneracao_media)
    ) |>
  summarise(n = n(),
            media = mean(valor_remuneracao_media)) |> 
  filter(
    ano == 2024 & 
      n >= 1000 
         ) |> 
  arrange(desc(media)) |> 

  select(id_municipio_nome) |> 
  pull() 

#View(lvls_municipio)



# Primeiro: Criar o dataframe processado
dados_municipios <- rais |> 
  filter(valor_remuneracao_media != 0.00 | !is.na(valor_remuneracao_media)) |>
  group_by(ano, id_municipio_nome) |> 
  summarise(
    media = mean(valor_remuneracao_media),
    .groups = 'drop'
  ) |> 
  mutate(ano = factor(ano, lvls_ano)) |>
  filter(id_municipio_nome %in% lvls_municipio)

# Segundo: Criar os dataframes para pontos e textos
pontos_municipios <- dados_municipios |> 
  filter(ano %in% c("2020", "2024"))

texto_municipios <- dados_municipios |> 
  filter(ano %in% c("2020", "2024"))

# Terceiro: Criar o gráfico
ggplot(dados_municipios, aes(x = ano, y = media, group = id_municipio_nome, color = id_municipio_nome)) +
  geom_line(size = 2) +
  geom_point(
    data = pontos_municipios,
    aes(x = ano, y = media), 
    color = "black", size = 3
  ) +
  scale_y_continuous(
    labels = scales::label_number(big.mark = ".", decimal.mark = ",")
  ) +
  geom_text_repel(
    data = texto_municipios,
    aes(
      x = ano, 
      y = media,
      label = scales::number(
        media, 
        prefix = "R$"
      )
    ), 
    nudge_x = -0.2, 
    direction = "both", 
    hjust = "right", 
    size = 5,
    vjust = 1
  ) +
  theme_classic() +
  theme(
    plot.title = element_text(size = 16, face = "bold"),
    plot.caption = element_text(size = 12, face = "bold", hjust = 0), 
    axis.title.y = element_text(size = 14, face = "bold"), 
    axis.title.x = element_text(size = 14, face = "bold"),
    axis.text.x = element_text(size = 12, face = "bold"),
    axis.text.y = element_text(size = 12, face = "bold"),
    legend.text = element_text(size = 14),
    panel.grid.major.x = element_line(color = "black", linetype = 3, size = 0.1),
    legend.position = "top",
    legend.justification = c("left", "top"),
    legend.title = element_text(size = 16, face = "bold")
  ) +
  labs(
    x = "Ano", 
    y = "Remuneração média", 
    color = "",
    title = "Remuneração média dos municípios que possuem mais de 1000 vínculos",
    subtitle = "Top 8",
    caption = "Fonte: Observatório Portuário - Dados da RAIS"
  ) +
  ggthemes::scale_color_gdocs() +
  guides(color = guide_legend(nrow = 1, keywidth = unit(1.5, "cm")))


```

# Trabalhadores da Gestão e Operação Portuária

```{r dados_uf_teste, include=FALSE, results='hide'}

uf <-
rais |>
  group_by(ano, id_municipio_nome) |>
  summarise(n = n()) |>
  mutate(id_municipio_nome = fct_reorder(id_municipio_nome, n),
         fill = ifelse(id_municipio_nome == "Santos", "um", "dois")) |> 
  arrange(n)

ord_uf <- 
  uf |> 
  filter(ano == 2020) |> 
  select(id_municipio_nome) |> 
  pull()

   uf <- uf |> mutate(id_municipio_nome = factor(id_municipio_nome, levels = ord_uf))


```

Em 2020, o Brasil apresentou `r uf |> group_by(ano) |> summarise(total = sum(n)) |> filter(ano == 2020) |> select(total) |> pull() |>  virgula()` vínculos de trabalho para a o setor **portuário** e **aquaviário**. Em `r uf |> group_by(ano) |> summarise(total = sum(n)) |> filter(total == max(total)) |> select(ano) |> pull()`, ano com a maior quantidade de vínculos da série, foram `r uf |> group_by(ano) |> summarise(total = sum(n)) |> filter(total == max(total)) |> select(total) |> pull() |> virgula()` vínculos. No entanto, os dois anos seguintes ocorreram duas reduções na quantidade de vínculos. Com essas reduções, o ano 2024, último ano da série histórica, a quantidade de vínculos foi de `r uf |> group_by(ano) |> summarise(total = sum(n)) |> filter(ano == 2024) |> select(total) |> pull() |>  virgula()`. Quanto aos estados, São Paulo e Rio de Janeiro permanceram na primeira e segunda coloção durante toda a série. Em 2024, por exempo, **Rio de Janeiro** possuía `r uf |> filter(ano == "2024" & n == max(n)) |> select(n) |> pull() |> virgula()` vínculos empregatícios e **São Paulo**, possuía cerca de `r uf |> filter(ano == "2024" & id_municipio_nome == "Santos") |> select(n) |> pull() |> virgula()`. Por outro lado, o estado do **Maranhão** possuía `r uf |> filter(ano == "2024" & id_municipio_nome == "Santos") |> select(n) |> pull()  |> virgula()` vínculos no último ano da série.

```{r r g_operacao_uf,  echo=FALSE, message=FALSE, warning=FALSE, results='hide', fig.width=12, fig.height=16}

# Primeiro: Processar os dados
dados_uf <- uf |>
  filter(!is.na(id_municipio_nome)) |> 
  mutate(ano = factor(ano, lvls_ano))

# Calcular totais para o subtítulo
total_2020 <- dados_uf |> 
  filter(ano == 2024) |> 
  pull(n) |> 
  sum()

total_2024 <- dados_uf |> 
  filter(ano == 2024) |> 
  pull(n) |> 
  sum()

# Criar dataframes para os textos
texto_top3 <- dados_uf |>
  group_by(ano) |>
  slice_max(order_by = n, n = 3)

texto_ma <- dados_uf |>
  filter(id_municipio_nome == "Santos")

# Segundo: Criar o gráfico
ggplot(dados_uf, aes(x = id_municipio_nome, y = n, fill = fill)) +
  geom_bar(position = "dodge", stat = "identity", width = 0.7) +
  coord_flip() +
  labs(
    x = "", 
    y = "Número de vínculos (em mil)",
    caption = "Fonte: Observatório Portuário - Dados da RAIS"
  ) +
  geom_text(
    data = texto_top3,
    aes(label = scales::number(n, big.mark = ".", suffix = " mil")), 
    hjust = -.1, 
    size = 2.5
  ) +
  geom_text(
    data = texto_ma,
    aes(label = scales::number(n, scale = 1/1000, decimal.mark = ",", 
                               big.mark = ".", accuracy = .01, suffix = " mil")), 
    hjust = -.1, 
    size = 2.5
  ) +
  ggtitle(
    "Empregados na Operação de Terminais Portuários por estado", 
    subtitle = str_c(
      "Eram ",
      scales::comma(total_2020, big.mark = ".", decimal.mark = ","),
      " vínculos de trabalho em todo o país em 2020 e ",
      scales::comma(total_2024, big.mark = ".", decimal.mark = ","),
      " vínculos em 2024"
    )
  ) +
  scale_fill_manual(values = c("lightblue", "#4682B4")) +
  scale_y_continuous(
    breaks = seq(0, 3*10^4, 10^4), 
    limits = c(0, 3.5*10^4),
    labels = scales::number_format(
      scale = 1/1000,
      big.mark = ".", 
      decimal.mark = ","
    )
  ) +
  facet_wrap(~ano, ncol = 3, scales = "fixed") +
  theme_classic() +
  theme(
    plot.title = element_text(
      family = "Helvetica", size = 20, 
      face = "bold", color = "#222222"
    ), 
    plot.subtitle = element_text(
      family = "Helvetica", size = 18, 
      margin = margin(9, 0, 9, 0)
    ),
    plot.caption = element_text(size = 12, face = "bold", hjust = 0), 
    axis.title.y = element_text(size = 14, face = "bold"), 
    axis.title.x = element_text(size = 14, face = "bold"),
    axis.text.x = element_text(size = 12, face = "bold"),
    axis.text.y = element_text(size = 10, face = "bold"),
    legend.position = "none",
    panel.grid.major.x = element_line(color = "black", linetype = 3, size = 0.1),
    panel.grid.major.y = element_blank(),
    strip.text.x = element_text(size = 14, face = "bold", hjust = 0),
    strip.background = element_blank()
  )


```

## Notas Metodológicas

Este relatório analisa dados da **Relação Anual de Informações Sociais (RAIS)** – registro administrativo obrigatório enviado anualmente por organizações públicas e privadas ao Ministério da Economia. A RAIS cobre estabelecimentos formais e permite acompanhar o estoque de vínculos empregatícios, incluindo tanto servidores estatutários quanto trabalhadores celetistas.

A análise adota uma **perspectiva longitudinal**, cobrindo o período de **2024 a 2024**, com foco no **setor portuário do estado de São Paulo**. Foram selecionados três municípios da **Região Metropolitana da Baixada Santista** – **Santos, Cubatão e Guarujá** – devido à sua relevância econômica e à concentração de atividades portuárias na região.

O recorte setorial foi realizado com base na **Classificação Nacional de Atividades Econômicas (CNAE 2.0)**, adotada oficialmente pelo Sistema Estatístico Nacional. A CNAE organiza as atividades em cinco níveis hierárquicos – Seções, Divisões, Grupos, Classes e Subclasses –, permitindo identificar com precisão os segmentos relacionados ao **transporte aquaviário e às atividades portuárias auxiliares**.

A seleção das subclasses CNAE considerou especificamente as atividades de transporte marítimo, navegação interior, apoio portuário, gestão de terminais e demais serviços auxiliares, conforme detalhado abaixo:

-   **H - TRANSPORTE, ARMAZENAGEM E CORREIO**
    -   **50 - TRANSPORTE AQUAVIÁRIO**
        -   **50.1 - Transporte marítimo de cabotagem e longo curso**
            -   **50.11-4 - Transporte marítimo de cabotagem**
                -   **5011-4/01**: Transporte marítimo de cabotagem - carga
                -   **5011-4/02**: Transporte marítimo de cabotagem - passageiros
            -   **50.12-2 - Transporte marítimo de longo curso**
                -   **5012-2/01**: Transporte marítimo de longo curso - carga
                -   **5012-2/02**: Transporte marítimo de longo curso - passageiros
        -   **50.2 - Transporte por navegação interior**
            -   **50.21-1 - Transporte por navegação interior de carga**
                -   **5021-1/01**: Transporte por navegação interior de carga, municipal, exceto travessia
                -   **5021-1/02**: Transporte por navegação interior de carga, intermunicipal, interestadual e internacional, exceto travessia
            -   **50.22-0 - Transporte por navegação interior de passageiros em linhas regulares**
                -   **5022-0/01**: Transporte por navegação interior de passageiros em linhas regulares, municipal, exceto travessia
                -   **5022-0/02**: Transporte por navegação interior de passageiros em linhas regulares, intermunicipal, interestadual e internacional, exceto travessia
        -   **50.3 - Navegação de apoio**
            -   **50.30-1 - Navegação de apoio**
                -   **5030-1/01**: Navegação de apoio marítimo
                -   **5030-1/02**: Navegação de apoio portuário
                -   **5030-1/03**: Serviço de rebocadores e empurradores
        -   **50.9 - Outros transportes aquaviários**
            -   **50.91-2 - Transporte por navegação de travessia**
                -   **5091-2/01**: Transporte por navegação de travessia, municipal
                -   **5091-2/02**: Transporte por navegação de travessia intermunicipal, interestadual e internacional
            -   **50.99-8 - Transportes aquaviários não especificados anteriormente**
                -   **5099-8/01**: Transporte aquaviário para passeios turísticos
                -   **5099-8/99**: Outros transportes aquaviários não especificados anteriormente
    -   **52 - ARMAZENAMENTO E ATIVIDADES AUXILIARES DOS TRANSPORTES**
        -   **52.3 - Atividades auxiliares dos transportes aquaviários**
            -   **52.31-1 - Gestão de portos e terminais**
                -   **5231-1/01**: Administração da infraestrutura portuária
                -   **5231-1/02**: Atividades do operador portuário
                -   **5231-1/03**: Gestão de terminais aquaviários
            -   **52.32-0 - Atividades de agenciamento marítimo**
                -   **5232-0/00**: Atividades de agenciamento marítimo
            -   **52.39-7 - Atividades auxiliares dos transportes aquaviários não especificadas anteriormente**
                -   **5239-7/01**: Serviços de praticagem
                -   **5239-7/99**: Atividades auxiliares dos transportes aquaviários não especificadas anteriormente

Foram incluídos apenas vínculos **ativos em 31 de dezembro de cada ano** (`vinculo_ativo_3112 = 1`), localizados nos municípios selecionados e pertencentes às subclasses do CNAE mencionadas. Esse critério garantiu que a amostra refletisse o **mercado de trabalho formal vigente** durante o período analisado.

As variáveis consideradas incluíram informações sobre ano de referência, tipo de vínculo, tipo de admissão, faixa de tempo de emprego, tempo de emprego, faixa de horas contratadas, quantidade de horas, indicadores de trabalho parcial e intermitente, faixa de remuneração média em salários mínimos e valor da remuneração média. Adicionalmente, foram analisadas características sociodemográficas dos trabalhadores, como idade, sexo, raça/cor, nacionalidade e grau de instrução, bem como informações sobre o estabelecimento, incluindo tipo, tamanho, natureza jurídica e adesão ao Simples Nacional.

Essa abordagem metodológica permitiu obter uma **visão detalhada e comparativa do setor privado**, considerando diferenças entre municípios, setores econômicos e perfis dos trabalhadores.

# **Glossário**

**Vínculo de emprego**: contrato de trabalho individual estabelecido entre uma pessoa física e uma organização.

**Estoque de emprego**: somatório do número de vínculos de emprego.

A seguir estão as atividades abarcadas pela Classificação Nacional de Atividades Econômicas (CNAE) mencionadas no relatório.

**Gestão de Portos e Terminais** compreende:

-   as atividades da administração da estrutura portuária, tais como o balizamento da área portuária, a manutenção da dragagem e das condições físicas do porto

-   as atividades de operação de terminais marítimos e fluviais, de uso público ou privado

-   o armazenamento no parque portuário de mercadorias provenientes ou destinadas às embarcações

-   a operação e gestão de equipamentos destinados a carga e descarga

-   a carga e descarga de embarcações
